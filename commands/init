#!/bin/sh

usage() {
cat << EOM >&2
usage: git template init

initialize an empty template

    -h, --help            help
EOM
exit 1
}

main() {
	local re='-+h(elp)?(\ |$)'; [[ "$@" =~ $re ]] && usage
	checkTemplateNotExist
	git init $DEFINE_TEMPLATE_GITPATH >/dev/null 2>&1
	[ $? != 0 ] && exit 1
	cd $DEFINE_TEMPLATE_GITPATH
	git config core.autocrlf true
	touch $DEFINE_TEMPLATE_CONFIG
	touch $DEFINE_TEMPLATE_README
	git add . >/dev/null 2>&1
	[ $? != 0 ] && exit 1
	git commit -m "initial"  >/dev/null 2>&1
	[ $? != 0 ] && exit 1
	touch $DEFINE_TEMPLATE_INSTANCE_CONFIG >/dev/null 2>&1
	lockTemplate
	# -- Bonus --
	# if project container is also in git then,
	# do a basic git command, to check if it's a git repo
	git status>/dev/null 2>&1 
	[ $? != 0 ] && exit 0
	# add template files to commit
	git add $DEFINE_TEMPLATE_ROOTPATH >/dev/null 2>&1
	exit 0
}

main "$@"